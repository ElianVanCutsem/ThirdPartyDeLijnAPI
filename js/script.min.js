var $jscomp={scope:{},findInternal:function(a,h,c){a instanceof String&&(a=String(a));for(var k=a.length,g=0;g<k;g++){var l=a[g];if(h.call(c,l,g,a))return{i:g,v:l}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,h,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[h]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,h,c,k){if(h){c=$jscomp.global;a=a.split(".");for(k=0;k<a.length-1;k++){var g=a[k];g in c||(c[g]={});c=c[g]}a=a[a.length-1];k=c[a];h=h(k);h!=k&&null!=h&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");
(function(a){function h(b,f,n,c){a.ajax({url:"https://api.delijn.be/DLKernOpenData/v1/beta/routeplan/"+b+"/"+f+"?"+a.param({aanvraagType:"INITIEEL",tijdstip:n+":00",vertrekAankomst:c}),beforeSend:function(a){a.setRequestHeader("Ocp-Apim-Subscription-Key","a256fd6a0f7a49da8b076533e33d4c83")},type:"GET",data:"{body}"}).done(function(b){console.log(b);var d;a("#resultTitle").empty().append("<h3>Found routes:</h3>");a("#results").empty();if(0==b.reiswegen.length)a("#resultsTitle").append("<h3>No routes found</h3>");
else for(var e=0;e<b.reiswegen.length;e++){var f="";d=b.reiswegen[e].duurtijd;f+="<li><a class='result'><img class='favouriteIcon' src='img/favourite.png'><h4>Route "+(e+1)+":</h4> "+d.start.substring(11,16)+" -> "+d.einde.substring(11,16)+" total duration: "+g(b.reiswegen[e].duurtijd.duurtijd)+"<img src='img/openDetails.png' class='detailsIcon rotateimg270'><img src='img/openDetails.png' class='detailsIcon rotateimg90'><ul class='details'>";for(d=0;d<b.reiswegen[e].reiswegStappen.length;d++)"VOERTUIG"==
b.reiswegen[e].reiswegStappen[d].type&&"BUS"==b.reiswegen[e].reiswegStappen[d].lijnType&&(f+="<li><img class='transportIcon' src='img/bus.png'><p>bus "+b.reiswegen[e].reiswegStappen[d].ritnummer+" from: "+b.reiswegen[e].reiswegStappen[d].vertrekPunt.naam+" to: "+b.reiswegen[e].reiswegStappen[d].aankomstPunt.naam+" </p></li>",f+="<li class='info'>"+g(b.reiswegen[e].reiswegStappen[d].duurtijd.duurtijd)+" - "+l(b.reiswegen[e].reiswegStappen[d].afstand)+"</li>"),"VOERTUIG"==b.reiswegen[e].reiswegStappen[d].type&&
"TREIN"==b.reiswegen[e].reiswegStappen[d].lijnType&&(f+="<li><img class='transportIcon' src='img/train.png'><p>"+b.reiswegen[e].reiswegStappen[d].lijnrichting.bestemming+" from: "+b.reiswegen[e].reiswegStappen[d].vertrekPunt.naam+" to: "+b.reiswegen[e].reiswegStappen[d].aankomstPunt.naam+"</p></li>",f+="<li class='info'>"+g(b.reiswegen[e].reiswegStappen[d].duurtijd.duurtijd)+" - "+l(b.reiswegen[e].reiswegStappen[d].afstand)+"</li>"),"WANDELEN"==b.reiswegen[e].reiswegStappen[d].type&&(f=b.reiswegen[e].reiswegStappen[d].hasOwnProperty("vertrekPunt")&&
b.reiswegen[e].reiswegStappen[d].hasOwnProperty("aankomstPunt")?f+("<li><img class='transportIcon' src='img/walk.png'><p> from: "+b.reiswegen[e].reiswegStappen[d].vertrekPunt.naam+" to: "+b.reiswegen[e].reiswegStappen[d].aankomstPunt.naam+"</p></li>"):b.reiswegen[e].reiswegStappen[d].hasOwnProperty("aankomstPunt")?f+("<li><img class='transportIcon' src='img/walk.png'><p> from: your location to: "+b.reiswegen[e].reiswegStappen[d].aankomstPunt.naam+"</p></li>"):f+("<li><img class='transportIcon' src='img/walk.png'><p> from: "+
b.reiswegen[e].reiswegStappen[d].vertrekPunt.naam+" to: your location</p></li>"),f+="<li class='info'>"+g(b.reiswegen[e].reiswegStappen[d].duurtijd.duurtijd)+" - "+l(b.reiswegen[e].reiswegStappen[d].afstand)+"</li>"),"WACHTEN"==b.reiswegen[e].reiswegStappen[d].type&&(f+="<li><img class='transportIcon' src='img/wait.png'><p>wait "+g(b.reiswegen[e].reiswegStappen[d].duurtijd.duurtijd)+"</p></li>");f+="</ul></a>";a("#results").append(f);a(".details").hide();a(".favouriteIcon").hide();a(".detailsIcon.rotateimg90").hide()}}).fail(function(){})}
function c(b,f){a.ajax({url:"https://api.delijn.be/DLZoekOpenData/v1/beta/zoek/haltes/"+b+"?",beforeSend:function(a){a.setRequestHeader("Ocp-Apim-Subscription-Key","a256fd6a0f7a49da8b076533e33d4c83")},type:"GET",data:"{body}"}).done(function(b){a(f).empty();if(0==b.aantalHits)a(f).append("<option value='-1'>no found locations</option>");else for(var c=0;c<b.haltes.length;c++)a(f).append("<option value='"+b.haltes[c].geoCoordinaat.latitude+","+b.haltes[c].geoCoordinaat.longitude+"'>"+b.haltes[c].omschrijving+
"</option>")}).fail(function(){console.log("there was an error searching locations")})}function k(b){b=b.coords.latitude+","+b.coords.longitude;a("#startSelect").append("<option value='"+b+"'>Your Location</option>");a("#destinationSelect").append("<option value='"+b+"'>Your Location</option>");a("#destinationSelect").show();a("#startSelect").show();a("#startSelect").val(b).change()}function g(a){a=a.substring(4,a.length-2);var b,c;if(4==a.length)return c=a.substring(2,3),c+"m";5==a.length&&(b=a.substring(0,
1),c=a.substring(2,4));6==a.length&&(b=a.substring(0,2),c=a.substring(3,5));return b+"h "+c+"m"}function l(a){return 1E3>a?"0."+a+"km ":a/1E3+"km "}function m(){if(0<localStorage.length){a("#favouritesTitle").text("Your favourite routes:").show();a("#favourites").empty();for(var b=0,f=localStorage.length;b<f;++b)a("#favourites").append(localStorage.getItem(localStorage.key(b)))}else a("#favouritesTitle").text("favourites").hide(),a("#favourites").empty()}a(document).ready(function(){console.log("Loaded");
a("#departureDate").val((new Date((new Date).valueOf()+36E5)).toJSON().slice(0,16));m();a("#start").empty();a("#destination").empty();a("#startSelect").hide();a("#destinationSelect").hide();a("#errorp").hide();a("#departureRadio").on("click",function(){a("#departureDateLabel").text("Date & time of departure")});a("#arrivalRadio").on("click",function(){a("#departureDateLabel").text("Date & time of arrival")});a("#start").on("keyup",function(){""!=a("#start").val().trim()&&(c(a("#start").val(),"#startSelect"),
a("#startSelect").show(),a("#start").removeClass("error"))});a("#destination").on("keyup",function(){""!=a("#destination").val().trim()&&(c(a("#destination").val(),"#destinationSelect"),a("#destination").removeClass("error"),a("#destinationSelect").show())});a("#locationButton").on("click",function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(k):console.log("Geolocation is not supported by this browser.")});a("#switch").on("click",function(){var b=a("#start").val(),f=a("#destination").val();
a("#destination").val(b);a("#start").val(f);c(a("#start").val(),"#startSelect");c(a("#destination").val(),"#destinationSelect")});a("#submitButton").on("click",function(){console.log("submit clicked");a("#results").empty();var b=!1;""==a("#destinationSelect").text()&&(a("#destination").addClass("error"),b=!0);""==a("#startSelect").text()&&(a("#start").addClass("error"),b=!0);b?a("#errorp").show():a("#errorp").hide();if(!b){console.log("search "+a("#startSelect").find(":selected").text()+" -> "+a("#destinationSelect").find(":selected").val());
var b=a("#startSelect").find(":selected").val(),f=a("#destinationSelect").find(":selected").val(),c=a("input[name=departureRadio]:checked").val();a("#results").append("<li>Searching the best route for you...</li>");h(b,f,a("#departureDate").val(),c)}});a("#results").on("click",".detailsIcon",function(b){a(b.currentTarget).parent().children("h4").slideToggle("10");a(".favouriteIcon").is(":hidden")&&a(b.currentTarget).parent().children().slideToggle()});a("#results").on("click",".favouriteIcon",function(b){if("img/favourited.png"==
a(b.currentTarget).attr("src")){console.log("removed favourite");for(var c=0,g=localStorage.length;c<g;++c)a(b.target).parent().parent().prop("outerHTML")==localStorage.getItem(localStorage.key(c))&&localStorage.removeItem(localStorage.key(c));a(b.currentTarget).attr("src","img/favourite.png");m()}else a(b.currentTarget).attr("src","img/favourited.png"),console.log("added to favourites"),b=a(b.target).parent().parent().prop("outerHTML"),"undefined"!==typeof Storage?(localStorage.setItem(new Date,
b),m()):console.log("Your browser doesn't support this function")});a("#favourites").on("click",".detailsIcon",function(b){a(b.currentTarget).parent().children("h4").slideToggle("10");a(b.currentTarget).parent().children().slideToggle()});a("#favourites").on("click",".favouriteIcon",function(b){console.log("removed favourite");for(var c=0,g=localStorage.length;c<g;++c)a(b.target).parent().parent().prop("outerHTML")==localStorage.getItem(localStorage.key(c))&&localStorage.removeItem(localStorage.key(c));
m()})})})(jQuery);
